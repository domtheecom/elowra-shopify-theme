<div class="product-reviews">
  <div class="reviews-header">
    <div class="reviews-summary">
      <div class="average-rating">
        <span class="rating-number">4.8</span>
        <div class="rating-stars">
          {% for i in (1..5) %}
            {% if i <= 4.8 %}
              <svg class="star star-filled" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            {% else %}
              <svg class="star" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            {% endif %}
          {% endfor %}
        </div>
        <span class="review-count">Based on 156 reviews</span>
      </div>
      
      <div class="rating-breakdown">
        <div class="rating-bar">
          <span>5 stars</span>
          <div class="bar"><div class="fill" style="width: 72%"></div></div>
          <span>72%</span>
        </div>
        <div class="rating-bar">
          <span>4 stars</span>
          <div class="bar"><div class="fill" style="width: 20%"></div></div>
          <span>20%</span>
        </div>
        <div class="rating-bar">
          <span>3 stars</span>
          <div class="bar"><div class="fill" style="width: 6%"></div></div>
          <span>6%</span>
        </div>
        <div class="rating-bar">
          <span>2 stars</span>
          <div class="bar"><div class="fill" style="width: 2%"></div></div>
          <span>2%</span>
        </div>
        <div class="rating-bar">
          <span>1 star</span>
          <div class="bar"><div class="fill" style="width: 0%"></div></div>
          <span>0%</span>
        </div>
      </div>
    </div>
    
    <button class="btn btn-secondary write-review-btn" onclick="toggleReviewForm()">
      Write a Review
    </button>
  </div>

  <div class="review-form" id="reviewForm" style="display: none;">
    {% form 'contact' %}
      <h3>Write a Review</h3>
      <input type="hidden" name="contact[tags]" value="product-review">
      <input type="hidden" name="contact[product]" value="{{ product.title }}">
      
      <div class="form-group">
        <label for="review-rating">Rating *</label>
        <div class="star-rating-input">
          {% for i in (1..5) %}
            <input type="radio" id="star{{ i }}" name="contact[rating]" value="{{ i }}" required>
            <label for="star{{ i }}">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            </label>
          {% endfor %}
        </div>
      </div>
      
      <div class="form-group">
        <label for="review-name">Name *</label>
        <input type="text" id="review-name" name="contact[name]" required>
      </div>
      
      <div class="form-group">
        <label for="review-email">Email *</label>
        <input type="email" id="review-email" name="contact[email]" required>
      </div>
      
      <div class="form-group">
        <label for="review-title">Review Title *</label>
        <input type="text" id="review-title" name="contact[title]" placeholder="Sum up your experience" required>
      </div>
      
      <div class="form-group">
        <label for="review-body">Your Review *</label>
        <textarea id="review-body" name="contact[body]" placeholder="Tell us about your experience with this product" required></textarea>
      </div>
      
      <div class="form-actions">
        <button type="submit" class="btn btn-primary">Submit Review</button>
        <button type="button" class="btn btn-secondary" onclick="toggleReviewForm()">Cancel</button>
      </div>
    {% endform %}
  </div>

  <div class="reviews-list">
    <div class="review-item verified">
      <div class="review-header">
        <div class="reviewer-info">
          <img src="https://images.unsplash.com/photo-1494790108755-2616b67b3f77?w=60&h=60&fit=crop&crop=face" alt="Sarah M." class="reviewer-avatar">
          <div>
            <h4>Sarah M.</h4>
            <span class="verified-badge">Verified Purchase</span>
          </div>
        </div>
        <div class="review-meta">
          <div class="review-rating">
            {% for i in (1..5) %}
              <svg class="star star-filled" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            {% endfor %}
          </div>
          <span class="review-date">2 weeks ago</span>
        </div>
      </div>
      <div class="review-content">
        <h5>"Perfect for sensitive skin!"</h5>
        <p>I've been using this for a month now and my skin has never looked better. No irritation, great hydration, and my redness has significantly decreased. Highly recommend for anyone with sensitive skin!</p>
        <div class="review-tags">
          <span class="tag">Sensitive Skin</span>
          <span class="tag">Hydrating</span>
        </div>
      </div>
    </div>

    <div class="review-item verified">
      <div class="review-header">
        <div class="reviewer-info">
          <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=60&h=60&fit=crop&crop=face" alt="Michael R." class="reviewer-avatar">
          <div>
            <h4>Michael R.</h4>
            <span class="verified-badge">Verified Purchase</span>
          </div>
        </div>
        <div class="review-meta">
          <div class="review-rating">
            {% for i in (1..5) %}
              <svg class="star star-filled" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            {% endfor %}
          </div>
          <span class="review-date">1 month ago</span>
        </div>
      </div>
      <div class="review-content">
        <h5>"Finally found something that works"</h5>
        <p>As someone with very dry skin, I've tried everything. This product actually delivers on its promises. My skin feels moisturized all day without any greasiness.</p>
        <div class="review-tags">
          <span class="tag">Dry Skin</span>
          <span class="tag">Long-lasting</span>
        </div>
      </div>
    </div>

    <div class="review-item verified">
      <div class="review-header">
        <div class="reviewer-info">
          <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=60&h=60&fit=crop&crop=face" alt="Emily L." class="reviewer-avatar">
          <div>
            <h4>Emily L.</h4>
            <span class="verified-badge">Verified Purchase</span>
          </div>
        </div>
        <div class="review-meta">
          <div class="review-rating">
            {% for i in (1..4) %}
              <svg class="star star-filled" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            {% endfor %}
            <svg class="star" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          </div>
          <span class="review-date">3 weeks ago</span>
        </div>
      </div>
      <div class="review-content">
        <h5>"Good product, gentle formula"</h5>
        <p>I have allergies to many skincare ingredients, but this has been working well for me. The texture is nice and it doesn't cause any reactions. Would buy again.</p>
        <div class="review-tags">
          <span class="tag">Allergy-prone</span>
          <span class="tag">Gentle</span>
        </div>
      </div>
    </div>
  </div>

  <div class="reviews-pagination">
    <button class="btn btn-secondary">Load More Reviews</button>
  </div>
</div>

<script>
function toggleReviewForm() {
  const form = document.getElementById('reviewForm');
  form.style.display = form.style.display === 'none' ? 'block' : 'none';
}

// Star rating functionality
document.querySelectorAll('.star-rating-input input').forEach(input => {
  input.addEventListener('change', function() {
    const rating = this.value;
    const stars = this.parentElement.querySelectorAll('label svg');
    stars.forEach((star, index) => {
      if (index < rating) {
        star.style.fill = '#fbbf24';
        star.style.stroke = '#fbbf24';
      } else {
        star.style.fill = 'none';
        star.style.stroke = 'currentColor';
      }
    });
  });
});
</script>

{% schema %}
{
  "name": "Product Reviews",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_reviews",
      "label": "Show reviews",
      "default": true
    }
  ]
}
{% endschema %}